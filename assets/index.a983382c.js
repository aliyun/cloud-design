import{_ as e,k as t,l as o,m as r,r as n,n as a,o as i,q as s,R as l,P as p,s as c,t as d,u,v as f,w as m,d as h,x as v,y as g,K as y,z as E}from"./index.d204dc79.js";var b=+new Date;function R(){return(b++).toString(36)}function U(e,t){var o=void 0!==e.uid?"uid":"name";return t.filter((function(t){return t[o]===e[o]}))[0]}var C={EXCEED_LIMIT:"EXCEED_LIMIT",BEFOREUPLOAD_REJECT:"BEFOREUPLOAD_REJECT",RESPONSE_FAIL:"RESPONSE_FAIL"},N=function(t,o){var r=t.listType,n=t.defaultFileList,a=t.fileList,i=e(t,["listType","defaultFileList","fileList"]);return"text-image"===r?(o("listType=text-image","listType=image","Upload"),i.listType="image"):"picture-card"===r?(o("listType=picture-card","listType=card","Upload"),i.listType="card"):i.listType=r,"defaultFileList"in t&&(o("defaultFileList","defaultValue","Upload"),i.defaultValue=n),"fileList"in t&&(o("fileList","value","Upload"),i.value=a),i},D=function(e){function n(){var t,a;o(this,n);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return t=a=r(this,e.call.apply(e,[this].concat(s))),a.saveUploaderRef=function(e){e&&"function"==typeof e.getInstance?a.uploaderRef=e.getInstance():a.uploaderRef=e},r(a,t)}return t(n,e),n.prototype.abort=function(e){this.uploaderRef.abort(e)},n.prototype.startUpload=function(){this.uploaderRef.startUpload()},n.prototype.isUploading=function(){return this.uploaderRef.isUploading()},n}(n.exports.Component);function P(e,t,o){o=o||"cannot post "+e.action+" "+t.status+"'";var r=new Error(o);return r.status=t.status,r.method=e.method,r.url=e.action,r}function w(e){var t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(o){return t}}function S(e){var t=new XMLHttpRequest;e.onProgress&&t.upload&&(t.upload.onprogress=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.onProgress(t)});var o=new FormData;e.data&&Object.keys(e.data).forEach((function(t){o.append(t,e.data[t])})),e.file instanceof Blob?o.append(e.filename,e.file,e.file.name):o.append(e.filename,e.file),t.onerror=function(t){e.onError(t)},t.onload=function(){if(t.status<200||t.status>=300)return e.onError(P(e,t),w(t));e.onSuccess(w(t),t)},e.method=e.method||"POST",t.open(e.method,e.action,!0);var r=e.timeout;"number"==typeof r&&r>0&&(t.timeout=r,t.ontimeout=function(){var o="Upload abort for exceeding time (timeout: "+r+"ms)";e.onError(P(e,t,o),w(t))}),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);var n=e.headers||{};for(var a in null!==n["X-Requested-With"]&&t.setRequestHeader("X-Requested-With","XMLHttpRequest"),n)n.hasOwnProperty(a)&&null!==n[a]&&t.setRequestHeader(a,n[a]);return t.send(o),{abort:function(){t.abort()}}}D.displayName="Base";var L,x,O,T,I=a.noop,F=function(){function e(t){o(this,e),this.options=i({beforeUpload:I,onProgress:I,onSuccess:I,onError:I,data:{},name:"file",method:"post"},t),this.reqs={}}return e.prototype.setOptions=function(e){i(this.options,e)},e.prototype.startUpload=function(e){var t=this;(e.length?Array.prototype.slice.call(e):[e]).forEach((function(e){e.uid=e.uid||R(),t.upload(e)}))},e.prototype.abort=function(e){var t=this.reqs;if(e){var o=e;e&&e.uid&&(o=e.uid),t[o]&&(t[o].abort(),delete t[o])}else Object.keys(t).forEach((function(e){t[e]&&t[e].abort&&t[e].abort(),delete t[e]}))},e.prototype.upload=function(e){var t=this,o=this.options,r=o.beforeUpload,n=o.action,i=o.name,l=o.headers,p=o.timeout,c=o.withCredentials,d=o.method,u=o.data,f=r(e,{action:n,name:i,headers:l,timeout:p,withCredentials:c,method:d,data:u});a.promiseCall(f,(function(o){if(!1===o){var r=new Error(C.BEFOREUPLOAD_REJECT);return r.code=C.BEFOREUPLOAD_REJECT,t.options.onError(r,null,e)}t.post(e,s.isPlainObject(o)?o:void 0)}),(function(o){var r=void 0;o?r=o:(r=new Error(C.BEFOREUPLOAD_REJECT)).code=C.BEFOREUPLOAD_REJECT,t.options.onError(r,null,e)}))},e.prototype.post=function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i({},this.options,o),n=r.action,a=r.name,s=r.headers,l=r.timeout,p=r.withCredentials,c=r.onProgress,d=r.onSuccess,u=r.onError,f=r.method,m=r.data;"function"==typeof m&&(m=m(e));var h=e.uid,v="function"==typeof r.request?r.request:S;this.reqs[h]=v({action:n,filename:a,file:e,data:m,timeout:l,headers:s,withCredentials:p,method:f,onProgress:function(t){c(t,e)},onSuccess:function(o){delete t.reqs[h],d(o,e)},onError:function(o,r){delete t.reqs[h],u(o,r,e)}})},e}(),k=a.noop,A=(x=L=function(e){function n(){var t,a;o(this,n);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return t=a=r(this,e.call.apply(e,[this].concat(s))),a.onSelect=function(e){var t=e.target.files,o=t.length?Array.prototype.slice.call(t):[t];o.forEach((function(e){e.uid=R()})),a.props.onSelect(o)},a.onClick=function(){var e=a.fileRef;e&&(e.value="",e.click())},a.onKeyDown=function(e){"Enter"===e.key&&a.onClick()},a.onDrop=function(e){e.preventDefault();var t=e.dataTransfer.files,o=Array.prototype.slice.call(t);a.props.onDrop(o)},a.onDragOver=function(e){e.preventDefault(),a.props.onDragOver(e)},a.saveFileRef=function(e){a.fileRef=e},r(a,t)}return t(n,e),n.prototype.render=function(){var e=this.props,t=e.accept,o=e.multiple,r=e.webkitdirectory,n=e.children,a=e.id,s=e.disabled,p=e.dragable,c=e.style,d=e.className,u=e.name,f={};return s||(f=i({onClick:this.onClick,onKeyDown:this.onKeyDown,tabIndex:"0"},p?{onDrop:this.onDrop,onDragOver:this.onDragOver,onDragLeave:this.props.onDragLeave}:{})),l.createElement("div",i({role:"application",style:c,className:d},f),l.createElement("input",{type:"file",name:u,id:a,ref:this.saveFileRef,style:{display:"none"},accept:t,"aria-hidden":!0,multiple:o,webkitdirectory:r?"":void 0,onChange:this.onSelect,disabled:s}),n)},n}(l.Component),L.propTypes={id:p.string,style:p.object,className:p.string,disabled:p.bool,multiple:p.bool,webkitdirectory:p.bool,dragable:p.bool,accept:p.string,onSelect:p.func,onDragOver:p.func,onDragLeave:p.func,onDrop:p.func,children:p.node,name:p.string},L.defaultProps={name:"file",multiple:!1,onSelect:k,onDragOver:k,onDragLeave:k,onDrop:k},x);A.displayName="Selecter";var j,M,q,z=(T=O=function(e){function n(){var t,a;o(this,n);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return t=a=r(this,e.call.apply(e,[this].concat(s))),a.getUploadOptions=function(e){return{action:e.action,name:e.name,timeout:e.timeout,method:e.method,beforeUpload:e.beforeUpload,onProgress:e.onProgress,onSuccess:e.onSuccess,onError:e.onError,withCredentials:e.withCredentials,headers:e.headers,data:e.data,request:e.request}},r(a,t)}return t(n,e),n.prototype.componentDidMount=function(){var e=this.props,t=this.getUploadOptions(e);this.uploader=new F(t)},n.prototype.componentDidUpdate=function(e){for(var t=this.getUploadOptions(e),o=this.getUploadOptions(this.props),r=Object.keys(o),n=0;n<r.length;n++){var a=r[n];if(o[a]!==t[a])return void this.uploader.setOptions(o)}},n.prototype.componentWillUnmount=function(){this.abort()},n.prototype.abort=function(e){this.uploader.abort(e)},n.prototype.startUpload=function(e){this.uploader.startUpload(e)},n.prototype.render=function(){var e=this.props,t=e.accept,o=e.multiple,r=e.webkitdirectory,n=e.children,a=e.id,i=e.disabled,s=e.dragable,p=e.style,c=e.className,d=e.onSelect,u=e.onDragOver,f=e.onDragLeave,m=e.onDrop,h=e.name;return l.createElement(A,{id:a,accept:t,multiple:o,webkitdirectory:r,dragable:s,disabled:i,className:c,style:p,onSelect:d,onDragOver:u,onDragLeave:f,onDrop:m,name:h},n)},n}(n.exports.Component),O.propTypes=i({},A.propTypes,{action:p.string,accept:p.string,data:p.oneOfType([p.object,p.func]),headers:p.object,withCredentials:p.bool,beforeUpload:p.func,onProgress:p.func,onSuccess:p.func,onError:p.func,children:p.node,timeout:p.number,method:p.oneOf(["post","put"]),request:p.func}),O.defaultProps=i({},A.defaultProps,{name:"file",multiple:!1,withCredentials:!0,beforeUpload:a.noop,onSelect:a.noop,onDragOver:a.noop,onDragLeave:a.noop,onDrop:a.noop,onProgress:a.noop,onSuccess:a.noop,onError:a.noop,onAbort:a.noop,method:"post"}),T);z.displayName="Html5Uploader";var _={position:"absolute",top:0,right:0,fontSize:9999,zIndex:9999,opacity:0,outline:"none",cursor:"pointer"},H=(M=j=function(e){function n(t){o(this,n);var a=r(this,e.call(this,t));return q.call(a),a.domain="undefined"!=typeof document&&document.domain?document.domain:"",a.uid=R(),a}return t(n,e),n.prototype.componentDidMount=function(){this.updateInputWH()},n.prototype.componentDidUpdate=function(){this.updateInputWH()},n.prototype.startUpload=function(){this.upload(this.file)},n.prototype.upload=function(e){var t=this;this.state.uploading||(this.state.uploading=!0,this.setState({uploading:!0}));var o=this.props,r=o.beforeUpload,n=o.action,a=o.name,i=o.data;if(!r)return this.post(e);var l=r(e,{action:n,name:a,data:i});l&&l.then?l.then((function(o){t.post(e,o)}),(function(){t.endUpload()})):!1!==l?this.post(e,s.isPlainObject(l)?l:void 0):this.endUpload()},n.prototype.endUpload=function(){this.file={},this.state.uploading&&(this.state.uploading=!1,this.setState({uploading:!1}))},n.prototype.updateInputWH=function(){var e=c.findDOMNode(this),t=this.inputEl;t.style.height=e.offsetHeight+"px",t.style.width=e.offsetWidth+"px"},n.prototype.abort=function(e){if(e){var t=e;e&&e.uid&&(t=e.uid),t===this.file.uid&&this.endUpload()}else this.endUpload()},n.prototype.post=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.formEl,r=this.dataEl,n=this.inputEl,a=this.props.data;"function"==typeof a&&(a=a(e));var i=t.action,s=t.name,l=t.data;s&&n.setAttribute("name",s),i&&o.setAttribute("action",i),l&&(a=l);var p=document.createDocumentFragment();for(var c in a)if(l.hasOwnProperty(c)){var d=document.createElement("input");d.setAttribute("name",c),d.value=a[c],p.appendChild(d)}r.appendChild(p),o.submit(),r.innerHTML="",this.props.onStart(e)},n.prototype.render=function(){var e=this.props,t=e.disabled,o=e.className,r=e.children,n=e.accept,a=e.name,s=e.style,p=a+"-"+this.uid+"-iframe";return l.createElement("span",{className:o,style:i({position:"relative",zIndex:0,display:"inline-block"},s)},t?null:l.createElement("iframe",{ref:this.saveIFrameRef,name:p,onLoad:this.onLoad,style:{display:"none"}}),l.createElement("form",{ref:this.saveFormRef,method:"post",action:this.props.action,encType:"multipart/form-data",target:p},l.createElement("input",{name:"_documentDomain",value:this.domain,type:"hidden"}),l.createElement("span",{ref:this.saveDataRef}),l.createElement("input",{ref:this.saveInputRef,type:"file",accept:n,name:a,onChange:this.onSelect,style:_})),r)},n}(l.Component),j.propTypes={style:p.object,action:p.string.isRequired,name:p.string.isRequired,data:p.oneOfType([p.object,p.func]),disabled:p.bool,className:p.string,children:p.node,headers:p.object,autoUpload:p.bool,onSelect:p.func,beforeUpload:p.func,onStart:p.func,onSuccess:p.func,onError:p.func,accept:p.string},j.defaultProps={name:"file",onSelect:a.noop,beforeUpload:a.noop,onStart:a.noop,onSuccess:a.noop,onError:a.noop,onAbort:a.noop},q=function(){var e=this;this.state={uploading:!1},this.file={},this.uid="",this.onLoad=function(){if(e.state.uploading){var t=e.props,o=e.file,r=void 0;try{var n=e.iFrameEl.contentDocument,a=n.getElementsByTagName("script")[0];a&&a.parentNode===n.body&&n.body.removeChild(a),r=n.body.innerHTML,t.onSuccess(r,o)}catch(i){d.warning("cross domain error for Upload. Maybe server should return document.domain script."),r="cross-domain",t.onError(i,null,o)}e.endUpload()}},this.onSelect=function(t){e.file={uid:R(),name:t.target.value},e.props.onSelect([e.file])},this.saveIFrameRef=function(t){e.iFrameEl=t},this.saveFormRef=function(t){e.formEl=t},this.saveDataRef=function(t){e.dataEl=t},this.saveInputRef=function(t){e.inputEl=t}},M);H.displayName="IframeUploader";var K,B,W=function(e){function n(){var t,a;o(this,n);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return t=a=r(this,e.call.apply(e,[this].concat(s))),a.state={Component:z},a.saveUploaderRef=function(e){a.uploaderRef=e},r(a,t)}return t(n,e),n.prototype.componentDidMount=function(){"undefined"==typeof File&&this.setState({Component:H})},n.prototype.abort=function(e){this.uploaderRef.abort(e)},n.prototype.startUpload=function(e){this.uploaderRef.startUpload(e)},n.prototype.render=function(){var e=this.state.Component;return l.createElement(e,i({},this.props,{ref:this.saveUploaderRef}))},n}(l.Component);W.displayName="Uploader";var J=(B=K=function(e){function n(){var t,i;o(this,n);for(var s=arguments.length,l=Array(s),p=0;p<s;p++)l[p]=arguments[p];return t=i=r(this,e.call.apply(e,[this].concat(l))),i.handleClose=function(e){var t=i.props,o=t.onRemove,r=t.uploader,n=o(e);a.promiseCall(n,(function(){r&&r.removeFile(e)}))},i.handleCancel=function(e){var t=i.props,o=t.onCancel,r=t.uploader,n=o(e);a.promiseCall(n,(function(){r&&r.abort(e)}))},i.onImageError=function(e,t){t.onerror=null,i.props.onImageError(t,e)},i.onPreview=function(e,t){i.props.onPreview(e,t)},r(i,t)}return t(n,e),n.prototype.componentDidUpdate=function(){var e=this,t=this.props,o=t.listType,r=t.useDataURL,n=t.value;"image"!==o&&"card"!==o||r&&n.forEach((function(t){"undefined"!=typeof document&&"undefined"!=typeof window&&window.FileReader&&window.File&&t.originFileObj instanceof File&&void 0===t.imgURL&&(t.imgURL="",function(e,t){var o=new FileReader;o.onloadend=function(){return t(o.result)},o.readAsDataURL(e)}(t.originFileObj,(function(o){t.imgURL=o,e.forceUpdate()})))}))},n.prototype.getInfo=function(e){var t,o=this.props.prefix+"upload";return{prefixCls:o,downloadURL:e.downloadURL||e.url,imgURL:e.imgURL||e.url,size:this.sizeCaculator(e.size),itemCls:f(((t={})[o+"-list-item"]=!0,t[o+"-list-item-"+e.state]=e.state,t[o+"-list-item-error-with-msg"]="error"===e.state&&e.errorMsg,t)),alt:e.name||e.alt}},n.prototype.sizeCaculator=function(e){var t=parseFloat(e,10);if(isNaN(t)||t<1e-7)return 0;for(var o=["B","K","M","G","T","P"],r=0;t>=1024&&r<o.length;)r++,t/=1024;var n=o[r];return""+(t=t.toFixed(2))+n},n.prototype.getTextList=function(e){var t=this,o=this.props,r=o.locale,n=o.extraRender,s=o.actionRender,p=o.progressProps,c=o.rtl,d=o.fileNameRender,u=this.getInfo(e),f=u.prefixCls,v=u.downloadURL,g=u.size,E=u.itemCls,b=function(){return"uploading"===e.state?t.handleCancel(e):t.handleClose(e)};return l.createElement("div",{className:E,key:e.uid||e.name},l.createElement("div",{className:f+"-list-item-name-wrap"},l.createElement("a",{href:v,target:"_blank",style:{pointerEvents:v?"":"none"},className:f+"-list-item-name"},l.createElement("span",null,d(e)),!!g&&l.createElement("span",{className:f+"-list-item-size",dir:c?"rtl":void 0},"(",g,")"),l.createElement("span",{className:f+"-extra"},n(e)))),"uploading"===e.state?l.createElement("div",{className:f+"-list-item-progress"},l.createElement(m,i({size:"medium",percent:e.percent,textRender:a.noop,rtl:c},p))):null,"error"===e.state&&e.errorMsg?l.createElement("div",{className:f+"-list-item-error-msg"},e.errorMsg):null,l.createElement("span",{className:f+"-list-item-op"},s(e),this.props.closable?l.createElement(h,{type:"close",size:"large",role:"button","aria-label":r.upload.delete,tabIndex:"0",onClick:b,onKeyDown:function(e){e.keyCode===y.ENTER&&b()}}):null))},n.prototype.getImageList=function(e){var t=this,o=this.props,r=o.extraRender,n=o.actionRender,s=o.progressProps,p=o.rtl,c=o.fileNameRender,d=this.getInfo(e),u=d.prefixCls,f=d.downloadURL,v=d.imgURL,g=d.size,E=d.itemCls,b=d.alt,R=null,U=function(){return"uploading"===e.state?t.handleCancel(e):t.handleClose(e)};return R="uploading"===e.state||"selected"===e.state&&!v?l.createElement(h,{type:"picture"}):"error"===e.state?l.createElement(h,{type:"cry"}):l.createElement("img",{src:v,onError:this.onImageError.bind(this,e),tabIndex:"0",alt:b,onClick:this.onPreview.bind(this,e)}),l.createElement("div",{className:E,key:e.uid||e.name},l.createElement("div",{className:u+"-list-item-thumbnail"},R),l.createElement("span",{className:u+"-list-item-op"},n(e),this.props.closable?l.createElement(h,{type:"close",size:"large",tabIndex:"0",role:"button",onClick:U,onKeyDown:function(e){e.keyCode===y.ENTER&&U()}}):null),l.createElement("a",{href:f,target:"_blank",style:{pointerEvents:f?"":"none"},className:u+"-list-item-name"},l.createElement("span",null,c(e)),!!g&&l.createElement("span",{className:u+"-list-item-size",dir:p?"rtl":void 0},"(",g,")"),l.createElement("span",{className:u+"-extra"},r(e))),"uploading"===e.state?l.createElement("div",{className:u+"-list-item-progress"},l.createElement(m,i({size:"medium",percent:e.percent,textRender:a.noop},s))):null,"error"===e.state&&e.errorMsg?l.createElement("div",{className:u+"-list-item-error-msg"},e.errorMsg):null)},n.prototype.getPictureCardList=function(e,t){var o=this,r=this.props,n=r.locale,s=r.progressProps,p=r.fileNameRender,c=r.itemRender,d=this.getInfo(e),u=d.prefixCls,f=d.downloadURL,g=d.imgURL,E=d.itemCls,b=d.alt,R=t?"":e.state,U=null;U="uploading"===R||"selected"===R&&!g?l.createElement("div",{className:u+"-list-item-handler"},l.createElement(h,{type:"picture"}),l.createElement(v,{text:!0,onClick:function(){return o.handleCancel(e)}},n.card.cancel)):"error"===R?l.createElement("div",{className:u+"-list-item-handler"},l.createElement(h,{type:"cry"})):l.createElement("img",{src:g,tabIndex:"0",alt:b,onError:this.onImageError.bind(this,e),onClick:this.onPreview.bind(this,e)});var C=function(){return o.handleClose(e)},N=null;return N="uploading"===R?[l.createElement("div",{className:u+"-list-item-thumbnail",key:"img"},U),l.createElement("div",{className:u+"-list-item-progress",key:"progress"},l.createElement(m,i({size:"medium",percent:e.percent,textRender:a.noop},s)))]:"function"==typeof c?c(e):[l.createElement("div",{className:u+"-list-item-thumbnail",key:"img"},U),l.createElement("span",{key:"tool",className:u+"-tool "+(this.props.closable?"":u+"-noclose")},l.createElement("a",{href:f,target:"_blank",tabIndex:f?"0":"-1",className:u+"-tool-download-link",style:{pointerEvents:f?"":"none"}},l.createElement(h,{type:f?"download":"","aria-label":n.card.download,className:u+"-tool-download-icon"})),this.props.closable&&!t?l.createElement("span",{className:u+"-tool-close"},l.createElement(h,{type:"ashbin","aria-label":n.card.delete,tabIndex:"0",role:"button",onClick:C,onKeyDown:function(e){e.keyCode===y.ENTER&&C()}})):null)],l.createElement("div",{className:E,key:e.uid||e.name},l.createElement("div",{className:u+"-list-item-wrapper"},N),l.createElement("span",{className:u+"-list-item-name"},p(e)))},n.prototype.render=function(){var e,t=this,o=this.props,r=o.listType,n=o.children,a=o.prefix,p=o.rtl,c=o.className,d=o.isPreview,u=a+"upload",m=[];if(d){var h,v=f(((h={})[a+"form-preview"]=!0,h[c]=!!c,h));m=this.props.value.map((function(e){if(!e)return null;var o=e.downloadURL;e.imgURL;var n=e.name;return"text"===r?l.createElement("div",{className:v},l.createElement("a",{href:o,target:"_blank"},n)):"image"===r||"card"===r?t.getPictureCardList(e,!0):null}))}else m=this.props.value.map((function(e){return e?"text"===r?t.getTextList(e):"image"===r?t.getImageList(e):"card"===r?t.getPictureCardList(e):null:null}));p&&"card"===r&&Array.isArray(m)&&(m=m.reverse());var g=d&&"image"===r?"card":this.props.listType,y=f(((e={})[u+"-list"]=!0,e[u+"-list-"+g]=!0,e),c),E=s.pickAttrsWith(this.props,"data-");return l.createElement("div",i({},E,{className:y,dir:p?"rtl":void 0}),p?n:m,p?m:n)},n}(n.exports.Component),K.propTypes={prefix:p.string,locale:p.object,listType:p.oneOf(["text","image","card"]),value:p.array,closable:p.bool,onRemove:p.func,onCancel:p.func,onImageError:p.func,onPreview:p.func,extraRender:p.func,actionRender:p.func,itemRender:p.func,progressProps:p.object,children:p.node,uploader:p.any,useDataURL:p.bool,rtl:p.bool,isPreview:p.bool,fileNameRender:p.func},K.defaultProps={prefix:"next-",listType:"text",value:[],locale:g.Upload,closable:!1,onRemove:a.noop,onCancel:a.noop,extraRender:a.noop,actionRender:a.noop,onImageError:a.noop,onPreview:a.noop,progressProps:{},fileNameRender:function(e){return e.name}},B);J.displayName="List";var X,V,G,Q,Y,Z,$,ee,te=u.config(J,{componentName:"Upload",transform:N}),oe=a.noop,re=E((V=X=function(n){function p(e){o(this,p);var t=r(this,n.call(this,e));G.call(t);var a=void 0;return a="value"in e?e.value:e.defaultValue,t.state={value:Array.isArray(a)?a:[],uploading:!1},t}return t(p,n),p.getDerivedStateFromProps=function(e,t){return"value"in e&&e.value!==t.value&&!t.uploading?{value:Array.isArray(e.value)?e.value:[]}:null},p.prototype.selectFiles=function(e){var t=e.length?Array.prototype.slice.call(e):[e];this.onSelect(t)},p.prototype.uploadFiles=function(e){this.state.uploading=!0;var t=e.filter((function(e){return"selected"===e.state&&(e.state="uploading",!0)})).map((function(e){return e.originFileObj}));t.length&&this.uploaderRef.startUpload(t)},p.prototype.startUpload=function(){this.uploadFiles(this.state.value)},p.prototype.replaceFiles=function(e,t){var o=U(e,this.state.value);o&&(t.uid=e.uid,o.originFileObj=t)},p.prototype.isUploading=function(){return this.state.uploading},p.prototype.render=function(){var t,o,r=this.props,n=r.listType,p=r.prefix,c=r.dragable,d=r.shape,u=r.className,m=r.style,v=r.useDataURL,g=r.disabled,y=r.limit,E=r.closable,b=r.beforeUpload,R=r.readonly,U=r.onRemove,C=r.onCancel,N=r.onPreview,D=r.list,P=r.extraRender,w=r.progressProps,S=r.rtl,L=r.isPreview,x=r.renderPreview,O=r.name,T=r.fileKeyName,I=void 0===T?O:T,F=r.fileNameRender,k=r.actionRender,A=e(r,["listType","prefix","dragable","shape","className","style","useDataURL","disabled","limit","closable","beforeUpload","readonly","onRemove","onCancel","onPreview","list","extraRender","progressProps","rtl","isPreview","renderPreview","name","fileKeyName","fileNameRender","actionRender"]),j=f(((t={})[p+"upload"]=!0,t[p+"upload-dragable"]=c,t[p+"disabled"]=g,t[p+"readonly"]=R,t[u]=u,t)),M=this.state.value.length>=y,q=f(((o={})[p+"upload-inner"]=!0,o[p+"hidden"]=M,o)),z=this.props.children;if("card"===d){var _,H=f(((_={})[p+"upload-card"]=!0,_[p+"disabled"]=g,_));z=l.createElement("div",{className:H},l.createElement(h,{size:"large",type:"add",className:p+"upload-add-icon"}),l.createElement("div",{tabIndex:"0",role:"button",className:p+"upload-text"},z))}if(L){if("function"==typeof x){var K,B=f(((K={})[p+"form-preview"]=!0,K[u]=!!u,K));return l.createElement("div",{style:m,className:B},x(this.state.value,this.props))}return n?l.createElement(te,{isPreview:!0,listType:n,style:m,className:u,value:this.state.value}):null}var J=g?a.prevent:U,X=s.pickAttrsWith(this.props,"data-");return l.createElement("div",i({className:j,style:m},X),l.createElement(W,i({},A,{name:I,beforeUpload:b,dragable:c,disabled:g||M,className:q,onSelect:this.onSelect,onDrop:this.onDrop,onProgress:this.onProgress,onSuccess:this.onSuccess,onError:this.onError,ref:this.saveUploaderRef}),z),n||D?l.createElement(te,{useDataURL:v,fileNameRender:F,actionRender:k,uploader:this,listType:n,value:this.state.value,closable:E,onRemove:J,progressProps:w,onCancel:C,onPreview:N,extraRender:P,rtl:S}):null)},p}(D),X.displayName="Upload",X.propTypes=i({},z.propTypes,te.propTypes,{prefix:p.string.isRequired,action:p.string,value:p.array,defaultValue:p.array,shape:p.oneOf(["card"]),listType:p.oneOf(["text","image","card"]),list:p.any,name:p.string,data:p.oneOfType([p.object,p.func]),formatter:p.func,limit:p.number,timeout:p.number,dragable:p.bool,closable:p.bool,useDataURL:p.bool,disabled:p.bool,onSelect:p.func,onProgress:p.func,onChange:p.func,onSuccess:p.func,afterSelect:p.func,onRemove:p.func,onError:p.func,beforeUpload:p.func,onDrop:p.func,className:p.string,style:p.object,children:p.node,autoUpload:p.bool,request:p.func,progressProps:p.object,rtl:p.bool,isPreview:p.bool,renderPreview:p.func,fileKeyName:p.string,fileNameRender:p.func,actionRender:p.func}),X.defaultProps=i({},z.defaultProps,{prefix:"next-",limit:1/0,autoUpload:!0,closable:!0,onSelect:oe,onProgress:oe,onChange:oe,onSuccess:oe,onRemove:oe,onError:oe,onDrop:oe,beforeUpload:oe,afterSelect:oe}),G=function(){var e=this;this.onSelect=function(t){var o=e.props,r=o.autoUpload,n=o.afterSelect,i=o.onSelect,s=o.limit,l=e.state.value.length+t.length,p=s-e.state.value.length;if(!(p<=0)){var c=t.map((function(e){var t=function(e){return e.uid||(e.uid=R()),{lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate,name:e.filename||e.name,size:e.size,type:e.type,uid:e.uid,error:e.error,percent:0,originFileObj:e}}(e);return t.state="selected",t})),d=c,u=[];l>s&&(d=c.slice(0,p),u=c.slice(p));var f=e.state.value.concat(c);e.state.value=f,r&&e.uploadFiles(d),i(d,f),u.forEach((function(t){var o=new Error(C.EXCEED_LIMIT);o.code=C.EXCEED_LIMIT,e.onError(o,null,t)})),r||(d.forEach((function(t){var o=n(t);a.promiseCall(o,a.noop,(function(o){e.onError(o,null,t)}))})),e.onChange(f,d))}},this.onDrop=function(t){e.onSelect(t),e.props.onDrop(t)},this.onProgress=function(t,o){e.state.uploading=!0;var r=e.state.value,n=U(o,r);n&&(i(n,{state:"uploading",percent:t.percent}),e.setState({value:r}),e.props.onProgress(r,n))},this.onSuccess=function(t,o){var r=e.props.formatter;r&&(t=r(t,o));try{"string"==typeof t&&(t=JSON.parse(t))}catch(l){return l.code=C.RESPONSE_FAIL,e.onError(l,t,o)}if(!1===t.success){var n=new Error(t.message||C.RESPONSE_FAIL);return n.code=C.RESPONSE_FAIL,e.onError(n,t,o)}var a=e.state.value,s=U(o,a);s&&(i(s,{state:"done",response:t,url:t.url,downloadURL:t.downloadURL||t.url}),e.props.useDataURL||(s.imgURL=t.imgURL||t.url),e.updateUploadingState(),e.onChange(a,s),e.props.onSuccess(s,a))},this.onError=function(t,o,r){var n=e.state.value,a=U(r,n);a&&(i(a,{state:"error",error:t,response:o}),e.updateUploadingState(),e.onChange(n,a),e.props.onError(a,n))},this.removeFile=function(t){t.state="removed",e.uploaderRef.abort(t);var o=e.state.value,r=U(t,o),n=o.indexOf(r);-1!==n&&(o.splice(n,1),e.onChange(o,r))},this.updateUploadingState=function(){e.state.value.some((function(e){return"uploading"===e.state}))||(e.state.uploading=!1)},this.abort=function(t){var o=e.state.value,r=U(t,o),n=o.indexOf(r);-1!==n&&(o.splice(n,1),e.onChange(o,r)),e.uploaderRef.abort(t)},this.onChange=function(t,o){e.setState({value:t}),e.props.onChange(t,o)}},V)),ne=E((Y=Q=function(e){function n(t){o(this,n);var a=r(this,e.call(this,t));Z.call(a);var i=void 0;return i="value"in t?t.value:t.defaultValue,a.state={value:Array.isArray(i)?i:[],uploaderRef:a.uploaderRef},a}return t(n,e),n.prototype.componentDidMount=function(){this.setState({uploaderRef:this.uploaderRef})},n.getDerivedStateFromProps=function(e,t){var o=t.uploaderRef&&t.uploaderRef.isUploading();return"value"in e&&e.value!==t.value&&!o?{value:Array.isArray(e.value)?[].concat(e.value):[]}:null},n.prototype.isUploading=function(){return this.state.uploaderRef.isUploading()},n.prototype.saveRef=function(e){this.saveUploaderRef(e)},n.prototype.render=function(){var e,t=this,o=this.props,r=o.action,p=o.disabled,c=o.prefix,d=o.locale,u=o.className,m=o.style,h=o.limit,v=o.onPreview,g=o.onRemove,y=o.onCancel,E=o.timeout,b=o.isPreview,R=o.renderPreview,U=o.itemRender,C=this.state.value.length>=h,N=f(((e={})[c+"upload-list-item"]=!0,e[c+"hidden"]=C,e)),D=this.props.children||d.card.addPhoto,P=p?a.prevent:g,w=s.pickOthers(n.propTypes,this.props),S=s.pickOthers(te.propTypes,w);if(b&&"function"==typeof R){var L,x=f(((L={})[c+"form-preview"]=!0,L[u]=!!u,L));return l.createElement("div",{style:m,className:x},R(this.state.value,this.props))}return l.createElement(te,i({className:u,style:m,listType:"card",closable:!0,locale:d,value:this.state.value,onRemove:P,onCancel:y,onPreview:v,itemRender:U,isPreview:b,uploader:this.state.uploaderRef},w),l.createElement(re,i({},S,{shape:"card",prefix:c,disabled:p,action:r,timeout:E,isPreview:b,value:this.state.value,onProgress:this.onProgress,onChange:this.onChange,ref:function(e){return t.saveRef(e)},className:N}),D))},n}(D),Q.displayName="Card",Q.propTypes={prefix:p.string,locale:p.object,children:p.object,value:p.oneOfType([p.array,p.object]),defaultValue:p.oneOfType([p.array,p.object]),onPreview:p.func,onChange:p.func,onRemove:p.func,onCancel:p.func,itemRender:p.func,onProgress:p.func,isPreview:p.bool,renderPreview:p.func},Q.defaultProps={prefix:"next-",locale:g.Upload,onChange:a.noop,onPreview:a.noop,onProgress:a.noop},Z=function(){var e=this;this.onProgress=function(t,o){e.setState({value:t}),e.props.onProgress(t,o)},this.onChange=function(t,o){"value"in e.props||e.setState({value:t}),e.props.onChange(t,o)}},Y)),ae=(ee=$=function(n){function a(){var e,t;o(this,a);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return e=t=r(this,n.call.apply(n,[this].concat(s))),t.state={dragOver:!1},t.onDragOver=function(e){t.state.dragOver||t.setState({dragOver:!0}),t.props.onDragOver(e)},t.onDragLeave=function(e){t.setState({dragOver:!1}),t.props.onDragLeave(e)},t.onDrop=function(e){t.setState({dragOver:!1}),t.props.onDrop(e)},t.saveUploaderRef=function(e){e&&"function"==typeof e.getInstance?t.uploaderRef=e.getInstance():t.uploaderRef=e},r(t,e)}return t(a,n),a.prototype.abort=function(e){this.uploaderRef.abort(e)},a.prototype.startUpload=function(){this.uploaderRef.startUpload()},a.prototype.render=function(){var t,o=this.props,r=o.className,n=o.style,a=o.shape,s=o.locale,p=o.prefix,c=o.listType,d=e(o,["className","style","shape","locale","prefix","listType"]),u=p+"upload-drag",m=f(((t={})[""+u]=!0,t[u+"-over"]=this.state.dragOver,t[r]=!!r,t)),v=this.props.children||l.createElement("div",{className:m},l.createElement("p",{className:u+"-icon"},l.createElement(h,{size:"large",className:u+"-upload-icon"})),l.createElement("p",{className:u+"-text"},s.drag.text),l.createElement("p",{className:u+"-hint"},s.drag.hint));return l.createElement(re,i({},d,{prefix:p,shape:a,listType:c,dragable:!0,style:n,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onDrop,ref:this.saveUploaderRef}),v)},a}(l.Component),$.propTypes={prefix:p.string,locale:p.object,shape:p.string,onDragOver:p.func,onDragLeave:p.func,onDrop:p.func,limit:p.number,className:p.string,style:p.object,defaultValue:p.array,children:p.node,listType:p.string,timeout:p.number},$.defaultProps={prefix:"next-",onDragOver:a.noop,onDragLeave:a.noop,onDrop:a.noop,locale:g.Upload},ee);ae.displayName="Dragger",re.Card=u.config(ne,{componentName:"Upload"}),re.Dragger=u.config(ae,{componentName:"Upload"}),re.Selecter=A,re.Uploader=F,re.ErrorCode=C,re.ImageUpload=u.config(ne,{componentName:"Upload",transform:function(e,t){t("Upload.ImageUpload","Upload.Card","Upload");var o=N(e,(function(){}));return o.locale&&o.locale.image&&(o.locale.card=o.locale.image),o}}),re.DragUpload=u.config(ae,{componentName:"Upload",transform:function(e,t){t("Upload.DragUpload","Upload.Dragger","Upload");var o=N(e,(function(){}));return o.listType||(o.listType="card"),o}}),re.Core=function(n){function a(e){o(this,a);var t=r(this,n.call(this,e));t.handleSelect=function(e){t.uploader.startUpload(e)};var i=t.props,s=i.action,l=i.name,p=i.method,c=i.beforeUpload,d=i.onProgress,u=i.onError,f=i.withCredentials,m=i.headers,h=i.data,v=i.onSuccess;return t.uploader=new F({action:s,name:l,method:p,beforeUpload:c,onProgress:d,onError:u,withCredentials:f,headers:m,data:h,onSuccess:v}),t}return t(a,n),a.prototype.abort=function(){this.uploader.abort()},a.prototype.render=function(){d.deprecated("Upload.Core","Upload.Selecter and Upload.Uploader","Upload");var t=this.props;t.action,t.name,t.method,t.beforeUpload,t.onProgress,t.onError,t.withCredentials,t.headers,t.data,t.onSuccess;var o=e(t,["action","name","method","beforeUpload","onProgress","onError","withCredentials","headers","data","onSuccess"]);return l.createElement(A,i({},N(o,(function(){})),{onSelect:this.handleSelect}))},a}(l.Component),re.List=te,re.CropUpload=function(){return d.deprecated("Upload.CropUpload","@alife/bc-next-crop-upload","Upload"),null};var ie=u.config(re,{transform:N});export{ie as N};
